

ext.setExtProperty = { propVarName, propVarValue ->
    if ( !project.ext.properties.containsKey(propVarName) ) {
        project.ext.set(propVarName, project.hasProperty(propVarName) ? project.findProperty(propVarName) : propVarValue ) ;
    }
}

ext.getUrlHost = { url ->
    if ( !url ) return null ;

    try {
        return "${url}".toURL().host
    }
    catch (Exception e) {
        return null ;
    }
}

ext.getHostIP = { host , purpose ->
    if ( !host ) return null ;

    try {
        return InetAddress.getByName(host).address.collect { it & 0xFF }.join('.')
    }
    catch (Exception e) {
        System.err.println "*** ${purpose} > CAN'T RESOLVE HOST: $host"
        return null
    }
}

ext {

    UNDEFINED = 'undefined' ;

    setExtProperty("organizationDomain", "UNDEFINED_DOMAIN") ;
    setExtProperty("organizationEmail", "contact@${organizationDomain}") ;

    setExtProperty("organizationNexusUrl", "https://nexus.${organizationDomain}") ;
    setExtProperty("organizationArtifactGroup", "UNDEFINED_GROUP") ;

    setExtProperty("organizationNexusUsername", "UNDEFINED_NEXUSUSER") ;
    setExtProperty("organizationNexusPassword", "UNDEFINED_NEXUSPASS") ;

    ////////////////////////

    theDomain = project.hasProperty('domain') ? "${domain}" : "${organizationDomain}"
    theEmail = project.hasProperty('email') ? "${email}" : "${organizationEmail}"

    theNexusUrl = project.hasProperty('nexusUrl') ? "${nexusUrl}" : "${organizationNexusUrl}"
    theNexusRepository = project.hasProperty('nexusRepository') ? "${nexusRepository}" : UNDEFINED
    theNexusGroup = project.hasProperty('nexusGroup') ? "${nexusGroup}" : 'maven-public'
    theNexusUsername = project.hasProperty('nexusUsername') ? "${nexusUsername}" : "${organizationNexusUsername}"
    theNexusPassword = project.hasProperty('nexusPassword') ? "${nexusPassword}" : "${organizationNexusPassword}"

    theArtifactGroup = project.hasProperty('artifactGroup') ? "${artifactGroup}" : "${organizationArtifactGroup}"

    theReleaseNumber = project.hasProperty('releaseNumber') ? "${releaseNumber}" : UNDEFINED
    theVersionSuffix = project.hasProperty('versionSuffix') ? "${versionSuffix}" : UNDEFINED
    theArtifactSuffix = project.hasProperty('artifactSuffix') ? "${artifactSuffix}" : UNDEFINED
    theEnvironment = project.hasProperty('environment') ? "${environment}" : UNDEFINED

    ////////////////////////
    
    println ""
    println "************************"
    println "** PROJECT PROPERTIES **"
    println "************************"
    println ""
    println "-- domain: ${theDomain}"
    println "-- email: ${theEmail}"
    println "-- artifactGroup: ${theArtifactGroup}"
    println "-- environment: ${theEnvironment}"
    println ""
    
    if ( !theNexusUrl.contains("UNDEFINED_DOMAIN") ) {
      println "Nexus:"
      println "-- nexusUrl: ${theNexusUrl}"
      println "-- nexusRepository: ${theNexusRepository}"
      println "-- nexusGroup: ${theNexusGroup}"
      println "-- nexusUsername: ${theNexusUsername}"
      println ""
    }

    println "************************"
    println ""
    
}
